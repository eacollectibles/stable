
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TESTING VERSION â€“ Buyback Portal</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, button { margin: 5px; padding: 8px; font-size: 14px; }
    #trade-result { margin-top: 20px; font-size: 16px; }
  </style>
</head>
<body>
  <div style="background: #ffd700; color: #000; text-align: center; font-weight: bold; padding: 10px;">
    TESTING VERSION ACTIVE
  </div>

  <h2>Trade-In Card</h2>
  <form id="trade-form">
    <input type="text" name="cardName" placeholder="Card Name" required />
    <input type="number" name="cardQty" placeholder="Qty" min="1" value="1" required />
    <button type="submit" id="submit-trade">Submit Trade</button>
  </form>

  <div id="trade-result"></div>

  <script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('trade-form');
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      const nameInput = document.querySelector('input[name="cardName"]');
      const qtyInput = document.querySelector('input[name="cardQty"]');
      const cardName = nameInput?.value || "Unknown Card";
      const quantity = parseInt(qtyInput?.value) || 1;

      fetch('/api/buybackstep4', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cardName: cardName })
      })
      .then(res => res.json())
      .then(data => {
        const totalValue = (data.tradeInValue * quantity).toFixed(2);
        document.getElementById("trade-result").innerHTML = `
          <div style="padding: 10px; border: 1px solid #ccc; background: #f9f9f9;">
            <strong>Card:</strong> ${data.name}<br>
            <strong>Condition:</strong> ${data.condition}<br>
            <strong>Quantity:</strong> ${quantity}<br>
            <strong>Estimated Buyback Value:</strong> <span style="color: green;">$${data.tradeInValue.toFixed(2)}</span><br>
            <strong>Total Offer:</strong> <span style="color: darkgreen; font-weight: bold;">$${totalValue}</span>
          </div>
        `;
      })
      .catch(err => {
        console.error("API error:", err);
        document.getElementById("trade-result").innerHTML = "<span style='color:red;'>Error contacting API.</span>";
      });
    });
  });
  </script>
</body>
</html>
