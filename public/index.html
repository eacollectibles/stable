<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Buyback Autocomplete</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    #results { border: 1px solid #ccc; max-width: 400px; }
    .result-item { padding: 5px; cursor: pointer; }
    .result-item:hover { background: #eee; }
  </style>
</head>
<body>

<h2>Buyback Autocomplete</h2>
<input type="text" id="search" placeholder="Type card name or number (e.g. 108/112)" autocomplete="off">
<div id="results"></div>

<script>
  const searchInput = document.getElementById('search');
  const resultsDiv = document.getElementById('results');
  let timeout = null;

  searchInput.addEventListener('input', function() {
    clearTimeout(timeout);
    const query = this.value.trim();
    if (query.length < 2) {
      resultsDiv.innerHTML = '';
      return;
    }

    timeout = setTimeout(() => {
      fetch(`/api/searchProducts?q=${encodeURIComponent(query)}`)
        .then(res => res.json())
        .then(data => {
          resultsDiv.innerHTML = '';
          data.forEach(item => {
            const div = document.createElement('div');
            div.className = 'result-item';
            div.innerText = `${item.title} (${item.card_number || item.sku}) - $${item.price}`;
            div.onclick = () => {
              searchInput.value = item.title;
              resultsDiv.innerHTML = '';
              // Add logic to autofill other fields as needed
            };
            resultsDiv.appendChild(div);
          });
        });
    }, 300);
  });
</script>

</body>
</html>