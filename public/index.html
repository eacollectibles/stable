
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TESTING VERSION – Trade In Portal</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    h1 { font-size: 2rem; margin-bottom: 20px; }
    .card-row { margin-bottom: 10px; display: flex; gap: 10px; align-items: center; }
    .card-row input, .card-row select { padding: 5px; flex: 1; }
    .remove-card { background: red; color: white; border: none; padding: 6px 10px; cursor: pointer; border-radius: 4px; }
    .results { margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px; }
    .results h2 { font-size: 1.25rem; margin-bottom: 10px; }
    .result-entry { margin-bottom: 8px; }
    .total { font-weight: bold; margin-top: 15px; font-size: 1.2rem; }
    button { padding: 8px 12px; border: none; background: #0077cc; color: white; border-radius: 4px; cursor: pointer; }
    button:hover { background: #005fa3; }
  </style>
</head>
<body>
<div style='background: #ffd700; color: #000; text-align: center; font-weight: bold; padding: 10px;'>TESTING VERSION ACTIVE</div>
  <h1>Trade In Portal</h1>
  <form>
    <div id="card-container">
      <div class="card-row">
        <input type="text" name="cardName" placeholder="Card Name" style="margin-right: 10px;">
        <input type="number" name="cardQty" placeholder="Qty" min="1" value="1" style="width: 60px;"> placeholder="Card Name" required />
        <select name="condition">
          <option value="NM">NM</option>
          <option value="LP">LP</option>
          <option value="MP">MP</option>
        </select>
        <button type="button" class="remove-card">❌ Remove</button>
      </div>
    </div>
    <button type="button" id="add-card">➕ Add Card</button>
    <button type="submit">Submit Trade</button>
  </form>

  <div class="results" id="results" style="display:none;">
    <h2>Trade Results</h2>
    <div id="result-list"></div>
    <div class="total" id="total-value"></div>
  </div>

  

<script>
document.getElementById('submit-trade')?.addEventListener('click', function() {
  const input = document.querySelector('input[name="cardName"]');
  const qtyInput = document.querySelector('input[name="cardQty"]');
  const cardName = input ? input.value : "Test Card";
  const quantity = qtyInput ? parseInt(qtyInput.value) || 1 : 1;

  fetch('/api/buybackstep4', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ cardName: cardName })
  })
  .then(res => res.json())
  .then(data => {
    const totalValue = (data.tradeInValue * quantity).toFixed(2);
    const resultDiv = document.getElementById("trade-result");
    resultDiv.innerHTML = `
      <div style="padding: 10px; border: 1px solid #ccc; background: #f9f9f9;">
        <strong>Card:</strong> ${data.name}<br>
        <strong>Condition:</strong> ${data.condition}<br>
        <strong>Quantity:</strong> ${quantity}<br>
        <strong>Estimated Buyback Value:</strong> <span style="color: green;">$${data.tradeInValue.toFixed(2)}</span><br>
        <strong>Total Offer:</strong> <span style="color: darkgreen; font-weight: bold;">$${totalValue}</span>
      </div>
    `;
  })
  .catch(err => {
    console.error("API error:", err);
    document.getElementById("trade-result").innerHTML = "<span style='color:red;'>Error contacting API. See console for details.</span>";
  });
});
</script>





<script>
document.getElementById('submit-trade')?.addEventListener('click', function() {
  const input = document.querySelector('input[name="cardName"]');
  const qtyInput = document.querySelector('input[name="cardQty"]');
  const cardName = input ? input.value : "Test Card";
  const quantity = qtyInput ? parseInt(qtyInput.value) || 1 : 1;

  fetch('/api/buybackstep4', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ cardName: cardName })
  })
  .then(res => res.json())
  .then(data => {
    const totalValue = (data.tradeInValue * quantity).toFixed(2);
    const resultDiv = document.getElementById("trade-result");
    resultDiv.innerHTML = `
      <div style="padding: 10px; border: 1px solid #ccc; background: #f9f9f9;">
        <strong>Card:</strong> ${data.name}<br>
        <strong>Condition:</strong> ${data.condition}<br>
        <strong>Quantity:</strong> ${quantity}<br>
        <strong>Estimated Buyback Value:</strong> <span style="color: green;">$${data.tradeInValue.toFixed(2)}</span><br>
        <strong>Total Offer:</strong> <span style="color: darkgreen; font-weight: bold;">$${totalValue}</span>
      </div>
    `;
  })
  .catch(err => {
    console.error("API error:", err);
    document.getElementById("trade-result").innerHTML = "<span style='color:red;'>Error contacting API. See console for details.</span>";
  });
});
</script>



<div id="trade-result" style="margin-top: 20px; font-size: 16px;"></div>
</body>
</html>
